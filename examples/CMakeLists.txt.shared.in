cmake_minimum_required(VERSION 3.21.0)

project(sockpuppet_demo CXX)

if(${CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT})
  # install to the build directory by default
  set(CMAKE_INSTALL_PREFIX "${CMAKE_BINARY_DIR}/install" CACHE PATH "" FORCE)
endif()

# grab all dependency info from the library's package file
find_package(sockpuppet REQUIRED
  HINTS "@CMAKE_INSTALL_PREFIX@/lib/cmake/sockpuppet" # search in last known install location
)

add_executable(sockpuppet_http_server sockpuppet_http_server.cpp)

# forward the dependency info to the target
target_link_libraries(sockpuppet_http_server sockpuppet)

# install the executable
install(TARGETS sockpuppet_http_server
  RUNTIME DESTINATION bin
)
if(${CMAKE_SYSTEM_NAME} MATCHES "Windows")
  # install sockpuppet DLL
  install(IMPORTED_RUNTIME_ARTIFACTS sockpuppet)
endif()
